---

- hosts: localhost

  vars:

    #################
    # Manala - Sudo #
    #################

    manala_sudo_sudoers_exclusive: true
    manala_sudo_sudoers:
      - file: manala
        config:
          - manala: 'ALL=(ALL) NOPASSWD:ALL'

    #####################
    # Manala - Accounts #
    #####################

    manala_accounts_groups:
      - group:  docker
        system: true
      - group: manala
        gid:   1000

    manala_accounts_users:
      - user:     manala
        uid:      1000
        shell:    /bin/bash
        password: $1$hVMBHhKk$4zC4YK.KRk3Vy9fmLd7681 # Empty password generated by "mkpasswd -s -m md5"
        group:    manala
        groups:
          - sudo
          - docker
        authorized_keys:
          - "{{ lookup('url', 'https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub') }}"

    ####################
    # Manala - Locales #
    ####################

    manala_locales_codes:
      - code:  en_US.UTF-8
        state: absent

    manala_locales_codes_default: C.UTF-8

    ####################
    # Manala - Ansible #
    ####################

    manala_ansible_config:
      - defaults:
          - force_color: 1
          - stdout_callback: actionable
          - display_skipped_hosts: false
          - system_warnings: false
          - deprecation_warnings: false
          - command_warnings: true
          - retry_files_enabled: true

    manala_ansible_hosts:
      - localhost

    manala_ansible_host_vars:
      - file: localhost.yml
        vars:
          - ansible_connection: local
          - ansible_become: true

  roles:
    - role: manala.sudo
    - role: manala.accounts
    - role: manala.locales
    - role: manala.ansible
